os:
  - linux
  - osx

compiler:
  - clang
language: c++
sudo: false
addons:
  apt:
    sources:
    - ubuntu-toolchain-r-test
    - kalakris-cmake
    packages:
    - perl
    - gcc-4.8
    - g++-4.8
    - python-dev
    - python-numpy
    - libxml2-dev
    - libboost-all-dev
    - cmake


env:
  global:  
    - secure: "YKhOFHBZMh9+B1F0H7/sDwPJ0fCeEr4sprT6oFjSQo80xp/j50GBiCvyLvyuBVQfHhwMAcfiBmTf2sC7nataT/AmQcxzOSa7swoVAGuk4SKYIDhrDLkw0aCkJf5lTzNH222uXKfPR/Qr6Wl+NqWausresI8lXMo7aSYFb1JAKlHPCVmyBK4t+7xlTVC6hNVURGGxZxi2A/DoC/QN8D24JXmjQv2KMF9M1eTc7z4181CKY3r9L33KrcJdrMJkNK+1GaikBgiqSAlKBnr8q9YtHqiyDRidOFrLrjUVER0q1mWyJG3Ak+5NFBzLDnz7GRi8nJPh8rK6kobisXsYrFhzeezwyF8NOz1b9dXgkOiBZ6ZvCwQmfwHXGBS6zn72I/WHLH6BgPD/zO5q8N3WVjV9DQRAZkrsVg/oloPY0UGC6sMNrLh0VS4IhUCqraZjuh/CD0R8jbPzrzqhLPOKaZPJXq9L7y6XuQwZndKPYous6nQwr+bkR+FwyUdfoUcbdBRLX+zjz0ChIYv+T/CmiINCTj/o4mpUgBebddPcIqiiU4KyDRAI4lz+3a0YnIfHLRclYEbpLtyCk0R6Kyvqy1WCxdmEjiGqF/soo2sH+GJLQ2vv6fxcJOGLzjcyWsvPqce0U3ztlDDDqlLzLcXMSxPIVJ/QwGyt3jnhAE2rnUYllfc="
    - secure: "MiaDVX4ExhuCXHKi4FoAEwzeBPco7s971A45h3EHfwNfuWU0RLydeLjzB05MZljMJ+jy5hgwjAAfQcNkFB9YAy8gbFUJO6h8jEg6FAoO6JK6cRYDEqbnPmEAyJfl169WH6BSydmQFTEsF8xcIJxsQ55EFZ7a8L3nR/lvrPHqBNxUB2jyyhuHbLdwXTGWHfjhUW671Zakgzx7wmZW3k4RrmkKMny+FAW6ZqLwvORsSaIBC6Gqh4h/0M3aIuliMt80Bd38fjV7CnssahKD/37TLGryXsS20191qjG1b8UUFWpecTAsb+WmMTXEc2Zo3nWFkQQ4NytFo3EHSv9CqPNX+zphUDPzxNZSZQCmoop6tgE+cJOhmS3Wrkx2EDQ5w0OrEN4C9vWwvSIB8tdWPoQxCsIBEYxj//wVR4NF7YnJ8+c8SJQAkLwZwicV8UWjvALiE71lmeYMdT/Lcr56PyyO0X+CwBwHzulCTtOp/S3187pm6YkU3AKKKIErU3WiX6DNPgkiZ9MiRj2hHzU5q9ze1lMUbrPnCW8MCUVi2WXUoQh8tys6Og7AwZ1675LIFiwi3jCX78zKwiXSMykDIKL//sgol7k4bFQ6UX3urRQS/UwcRpG7/NT5wlDBa+OpUVeQZBVtixNWHIFJK/0ruLvH7HSIetS7E7aVRtLtWLRuRBU="


notifications:
  slack:
    rooms:
      - secure: Rxjp4bNLl/kx9dbQxpXtHi2KEl7M25/gJcG874IlF40B9tnPwRmGm+w8m3smQW7gRNLyZ6VfoBcmuGet+GMBTCCa44dCcm9qkx+OZJkOBv/C5TLEO4dBtAMFDhRRmpr2LhZfxvbC0R0CRP3wzGIea4RWFJBcvF/oAtGxYSfISpEE745DDY/W9yNRk3AchFDvb9T3f6ip3JDJnamdBh5xMUD1Ou6HiTUjXm4qrwwG89Lf9MrzmN3LOuP/+wE/w+wz4MeEYuPWMfQIYGdI0Bhz7zglmRpBPX4F6FSN9LyBrTORZz09erXLwcz7kyP+LfA3cXrvoMSD4eR8mSyRxV20o7p5+phHNdYkpohmoOwOPO7cT/yfSSjQIzCN4NYeIxTTXed4AyAfDFCVrB8o5sqs2QC1O7MuNOgKw1DDvUMNRLd+8x41xpdr0dZC1OxgJ0glURaHq1e7C2GqjzKgd0wm1bYhnOWWLMwe4S9mrxo8/bKG6JQ0TchXkr5PHo02QT+HTiDysDgsa+etyM4zIMbNpp3aYQsNMxu3IOgzINUgcnoVreyXlht1QGEu8I6WIWNWYnBmdjx+aK7V2dKeEx5LLqJ/RO5+CWaXyYIdg7EYQn/WIx9Z5ifCs4s8m7ZqKYd6D+1KpfrrhMtnZ/uTJ/HVHkLwyW7DX/caRn7kpnQU5Xc=
    template:
      - "NFsim build: %{result} in %{duration}"
      - "Build: <%{build_url}|#%{build_number}> (<%{compare_url}|%{commit}>) Author: %{author}"   
      - "To download the NFsim executable, "
      - "Goto: https://rawgit.com/RuleWorld/nfsim/master/.NFsim_Beta.html"
      - "To package NFsim, please make a small modification to BioNetGen:"
      - "Goto: https://github.com/RuleWorld/bionetgen"
      - "Build details:  %{build_url} "


before_install:
- source osx_install.sh

install:
    - if [ "$CXX" = "g++" ]; then export CXX="g++-4.8" CC="gcc-4.8"; fi

script: 
  - mkdir -p build; mkdir -p dist; cd build; cmake ..; make; cp NFsim ../dist; cp NFsim ../dist/NFsim-$TRAVIS_OS_NAME ;cd ..; 
  - cd validate;tar xfj bionetgen-2.2.6.tar.bz2
  - python validate.py
  - cd ..
  
after_success:
  - perl .make_tar.pl  --platform $TRAVIS_OS_NAME
  - "curl -T ./dist/NFsim-$TRAVIS_OS_NAME               -u $FTP_USER:$FTP_PASSWORD ftp://ftp.drivehq.com/d_data/d_travis/"  
  - "curl -T ./dist/NFsim-source-$TRAVIS_OS_NAME.tar.gz -u $FTP_USER:$FTP_PASSWORD ftp://ftp.drivehq.com/d_data/d_travis/"  

#    The FTP_USER and FTP_PASSWORD strings are actually defined in the env: global: -secure: strings above.  Those strings
#  Were generated using a program that may be installed on Linux.  Documentation can be found at: https://docs.travis-ci.com/user/encryption-keys/
#  To make a long story short, the program may be installed on Linux with:      gem install travis
#  the command to generate the FTP_PASSWORD string is
#
#              travis encrypt  FTP_USER="password" --skip-version-check -r RuleWorld/nfsim
#
#  The password should be surroundedd by double quotes, and the -r parameter indicates the repository for which the password
#  will be used.
#
